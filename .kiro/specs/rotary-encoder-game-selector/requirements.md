# Requirements Document

## Introduction

ロータリーエンコーダーを使用してゲーム選択を行う機能を実装します。この機能により、ユーザーはゲーム実行中にロータリーエンコーダーを回すことでゲーム選択モードに入り、7 セグメントディスプレイでゲーム番号を確認しながら、ボタン操作でゲームを変更またはキャンセルできるようになります。

## Requirements

### Requirement 1

**User Story:** ゲームプレイヤーとして、ゲーム実行中にロータリーエンコーダーを回すことで、現在のゲームを一時停止してゲーム選択モードに入りたい

#### Acceptance Criteria

1. WHEN ロータリーエンコーダーが回転した THEN システム SHALL 現在のゲームを一時停止する
2. WHEN ロータリーエンコーダーが回転した THEN システム SHALL ゲーム選択モードに移行する
3. WHEN ゲーム選択モードに入った THEN システム SHALL 7 セグメントディスプレイにゲーム番号を表示する

### Requirement 2

**User Story:** ゲームプレイヤーとして、ゲーム選択モード中に 7 セグメントディスプレイで現在選択されているゲーム番号を確認したい

#### Acceptance Criteria

1. WHEN ゲーム選択モードがアクティブな時 THEN システム SHALL 7 セグメントディスプレイの 1 桁目に「-」を表示する
2. WHEN ゲーム選択モードがアクティブな時 THEN システム SHALL 7 セグメントディスプレイの 4 桁目に「-」を表示する
3. WHEN ゲーム選択モードがアクティブな時 THEN システム SHALL 7 セグメントディスプレイの 2~3 桁目に現在選択されているゲーム番号を表示する
4. WHEN ロータリーエンコーダーが回転した AND ゲーム選択モードがアクティブな時 THEN システム SHALL 選択されているゲーム番号を変更する

### Requirement 3

**User Story:** ゲームプレイヤーとして、ゲーム選択モード中に btn_a を押すことで選択したゲームに変更したい

#### Acceptance Criteria

1. WHEN btn_a が押された AND ゲーム選択モードがアクティブな時 THEN システム SHALL 現在選択されているゲームに変更する
2. WHEN ゲームが変更された THEN システム SHALL 新しいゲームを初期化する
3. WHEN ゲームが変更された THEN システム SHALL ゲーム選択モードを終了する
4. WHEN ゲームが変更された THEN システム SHALL 新しいゲームの実行を開始する

### Requirement 4

**User Story:** ゲームプレイヤーとして、ゲーム選択モード中に btn_b を押すことでゲーム選択をキャンセルして元のゲームを再開したい

#### Acceptance Criteria

1. WHEN btn_b が押された AND ゲーム選択モードがアクティブな時 THEN システム SHALL ゲーム選択をキャンセルする
2. WHEN ゲーム選択がキャンセルされた THEN システム SHALL ゲーム選択モードを終了する
3. WHEN ゲーム選択がキャンセルされた THEN システム SHALL 一時停止していたゲームを再開する
4. WHEN ゲーム選択がキャンセルされた THEN システム SHALL 7 セグメントディスプレイを元の表示に戻す

### Requirement 5

**User Story:** ゲームプレイヤーとして、ゲーム選択時に利用可能なすべてのゲームから選択したい

#### Acceptance Criteria

1. WHEN ロータリーエンコーダーが時計回りに回転した AND ゲーム選択モードがアクティブな時 THEN システム SHALL 次のゲーム番号を選択する
2. WHEN ロータリーエンコーダーが反時計回りに回転した AND ゲーム選択モードがアクティブな時 THEN システム SHALL 前のゲーム番号を選択する
3. WHEN 最後のゲームが選択されている AND ロータリーエンコーダーが時計回りに回転した THEN システム SHALL 最初のゲームを選択する
4. WHEN 最初のゲームが選択されている AND ロータリーエンコーダーが反時計回りに回転した THEN システム SHALL 最後のゲームを選択する

### Requirement 6

**User Story:** システム開発者として、ゲーム選択機能が既存のゲームループに影響を与えないようにしたい

#### Acceptance Criteria

1. WHEN ゲーム選択モードがアクティブでない時 THEN システム SHALL 通常のゲームループを実行する
2. WHEN ゲーム選択モードがアクティブな時 THEN システム SHALL ゲームの更新処理を一時停止する
3. WHEN ゲーム選択モードがアクティブな時 THEN システム SHALL LED マトリクスの表示を維持する
4. WHEN ゲーム選択モードから復帰した時 THEN システム SHALL ゲームの状態を保持する
